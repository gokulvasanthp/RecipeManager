<div class="dashboard-container">
  <div class="header">
    <h1>Dashboard</h1>
  </div>

  <app-plc-status [status]="plcStatus"></app-plc-status>

  <div *ngIf="error" class="alert alert-error">{{ error }}</div>

  <div class="dashboard-grid">
    <div class="stat-card">
      <h3>Total Recipes</h3>
      <p class="stat-value">{{ recipes.length }}</p>
    </div>

    <div class="stat-card">
      <h3>Running Batches</h3>
      <p class="stat-value running">{{ getRunningBatches().length }}</p>
    </div>

    <div class="stat-card">
      <h3>Pending Batches</h3>
      <p class="stat-value pending">{{ getPendingBatches().length }}</p>
    </div>

    <div class="stat-card">
      <h3>Completed Batches</h3>
      <p class="stat-value completed">{{ getCompletedBatches().length }}</p>
    </div>
  </div>

  <div class="section">
    <h2>Running Batches</h2>
    <div *ngIf="getRunningBatches().length === 0" class="empty">No running batches</div>
    <table *ngIf="getRunningBatches().length > 0" class="batches-table">
      <thead>
        <tr>
          <th>Batch Number</th>
          <th>Target Qty</th>
          <th>Status</th>
          <th>Operator</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let batch of getRunningBatches()">
          <td>{{ batch.batchNumber }}</td>
          <td>{{ batch.targetQuantity }}</td>
          <td><span class="badge badge-running">{{ batch.status }}</span></td>
          <td>{{ batch.operatorName || '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="section">
    <h2>Recent Batches</h2>
    <div *ngIf="batchRuns.length === 0" class="empty">No batch runs</div>
    <table *ngIf="batchRuns.length > 0" class="batches-table">
      <thead>
        <tr>
          <th>Batch Number</th>
          <th>Recipe</th>
          <th>Status</th>
          <th>Started</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let batch of batchRuns | slice:0:10">
          <td>{{ batch.batchNumber }}</td>
          <td>Recipe {{ batch.recipeId }}</td>
          <td><span [class]="'badge badge-' + batch.status.toLowerCase()">{{ batch.status }}</span></td>
          <td>{{ batch.startedAt | date:'short' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
